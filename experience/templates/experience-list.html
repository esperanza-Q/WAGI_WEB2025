{% extends 'base.html' %}
{% load static %}

{% block head_extra %}
  <link rel="stylesheet" href="{% static 'css/experience/experience-list.css' %}">
{% endblock %}

{% block content %}
  <div class="container">

    <form method="GET" id="filter-form" class="ex-search-form" action="{% url 'search:search-expr-test' %}">

      <div class="ex-search-section">
        <input
          type="search"
          placeholder="활동명으로 검색하기"
          class="ex-search-input"
          name="q"
          value="{{ request.GET.q }}"
        />

        <button type="submit" class="ex-search-btn">
          <img src="{% static 'img/search.svg' %}" alt="검색">
        </button>
      </div>

      <input type="hidden" name="category" id="hidden-category" value="{{ category }}">
      <input type="hidden" name="order" id="hidden-order" value="{{ order }}">

      <nav class="ex-filter-tabs">
        <ul>
          <li><button type="button" class="tab-btn" onclick="setCategory('')">전체</button></li>
          <li><button type="button" class="tab-btn" onclick="setCategory('club')">동아리</button></li>
          <li><button type="button" class="tab-btn" onclick="setCategory('academic')">학회</button></li>
          <li><button type="button" class="tab-btn" onclick="setCategory('contest')">공모전</button></li>
          <li><button type="button" class="tab-btn" onclick="setCategory('intern')">인턴</button></li>
        </ul>
      </nav>

      <div class="ex-sub-filter-bar">
        <div class="ex-sub-filters">
          <ul>
            <li><button type="button" class="order-btn" onclick="setOrder('latest')">최신순</button></li>
            <li><button type="button" class="order-btn" onclick="setOrder('rating')">평점순</button></li>
            <li><button type="button" class="order-btn" onclick="setOrder('agree')">공감순</button></li>
          </ul>
        </div>
      </div>

      <div class="ex-sub-filter-row">
        <div class="ex-custom-filter">
          <select class="ex-filter-select" name="college">
            <option value="">단과대 전체</option>
            <option value="공과대학">공과대학</option>
            <option value="인문대학">인문대학</option>
            <option value="간호대학">간호대학</option>
            <option value="미술대학">미술대학</option>
            <option value="법과대학">법과대학</option>
            <option value="사범대학">사범대학</option>
            <option value="사회과학대학">사회과학대학</option>
            <option value="생활산업대학">생활산업대학</option>
            <option value="인문융합예술대학">인문융합예술대학</option>
            <option value="사회과학대학">사회과학대학</option>
            <option value="자연과학대학">자연과학대학</option>
          </select>

          <select class="ex-filter-select" name="department">
            <option value="">학과 전체</option>
            <option value="간호학과">간호학과</option>
            <option value="바이오생명공학과">바이오생명공학과</option>
            <option value="바이오식품공학과">바이오식품공학과</option>
            <option value="바이오신약의과학부">바이오신약의과학부</option>
            <option value="청정신소재공학과">청정신소재공학과</option>
            <option value="AI융합학부">AI융합학부</option>
            <option value="서비스·디자인공학과">서비스·디자인공학과</option>
            <option value="융합보안공학과">융합보안공학과</option>
            <option value="컴퓨터공학과">컴퓨터공학과</option>
            <option value="공예과">공예과</option>
            <option value="동양화과">동양화과</option>
            <option value="디자인과">디자인과</option>
            <option value="서양화과">서양화과</option>
            <option value="조소과">조소과</option>
            <option value="법학부">법학부</option>
            <option value="교육학과">교육학과</option>
            <option value="사회교육과">사회교육과</option>
            <option value="유아교육과">유아교육과</option>
            <option value="윤리교육과">윤리교육과</option>
            <option value="한문교육과">한문교육과</option>
            <option value="경영학과">경영학과</option>
            <option value="경제학과">경제학과</option>
            <option value="미디어커뮤니케이션학과">미디어커뮤니케이션학과</option>
            <option value="사회복지학과">사회복지학과</option>
            <option value="심리학과">심리학과</option>
            <option value="정치외교학과">정치외교학과</option>
            <option value="지리학과">지리학과</option>
            <option value="뷰티산업학과">뷰티산업학과</option>
            <option value="소비자산업학과">소비자산업학과</option>
            <option value="스포츠과학부">스포츠과학부</option>
            <option value="의류산업학과">의류산업학과</option>
            <option value="기악과">기악과</option>
            <option value="성악과">성악과</option>
            <option value="작곡과">작곡과</option>
            <option value="국어국문학과">국어국문학과</option>
            <option value="독일어문·문화학과">독일어문·문화학과</option>
            <option value="무용예술학과">무용예술학과</option>
            <option value="문화예술경영학과">문화예술경영학과</option>
            <option value="미디어영상연기학과">미디어영상연기학과</option>
            <option value="사학과">사학과</option>
            <option value="영어영문학과">영어영문학과</option>
            <option value="일본어문·문화학과">일본어문·문화학과</option>
            <option value="중국어문·문화학과">중국어문·문화학과</option>
            <option value="프랑스어문·문화학과">프랑스어문·문화학과</option>
            <option value="현대실용음악학과">현대실용음악학과</option>
            <option value="바이오헬스융합학부">바이오헬스융합학부</option>
            <option value="수리통계데이터사이언스학과">수리통계데이터사이언스학과</option>
            <option value="화학·에너지융합학부">화학·에너지융합학부</option>
            <option value="심리학과">심리학과</option>

          </select>

          <select class="ex-filter-select" name="grade">
            <option value="">학년 전체</option>
            <option value="1">1학년</option>
            <option value="2">2학년</option>
            <option value="3">3학년</option>
            <option value="4">4학년</option>
            <option value="5">휴학</option>
            <option value="6">졸업</option>
          </select>

          <button type="submit" class="ex-custom-filter-btn">
            맞춤 검색
          </button>
        </div>
        <a class="ex-write-btn" href="{% url 'experience:review_create' %}">글쓰기</a>
      </div>

    </form>

    <div class="ex-divider"></div>

    <div class="ex-card-list">
      {% for r in reviews %}

        <a href="{% url 'experience:review_detail' r.id %}" class="ex-card-link">
          <div class="ex-card">
            <div class="ex-card-header">
              <div class="ex-card-category">{{ r.get_category_display }}</div>
              <div class="ex-card-date">{{ r.created_at|date:"Y.m.d" }}</div>
            </div>
            <div class="ex-card-title">{{ r.title }}</div>
            <div class="ex-card-nickname">{{ r.user.display_name }}</div>
            <div class="ex-card-period">{{ r.activity_period }}</div>
            <div class="ex-card-footer">
              <div class="ex-card-star">평점 {{ r.rating }}</div>
              <div class="ex-card-like"><img class="ex-card-like-img" src="{% static 'img/like.svg' %}">{{ r.like_count_db }}</div>
            </div>
          </div>
        </a>
      {% endfor %}
      </div>

    <div class="ex-pagination">
      <button class="ex-page-btn">&lt;</button>
      <button class="ex-page-btn active">1</button>
      <button class="ex-page-btn">2</button>
      <button class="ex-page-btn">3</button>
      <button class="ex-page-btn">&gt;</button>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  <script src="{% static 'js/experience-list.js' %}"></script>
  <script>
    function setCategory(val) {
      document.getElementById('hidden-category').value = val;
      document.getElementById('filter-form').submit();
    }
    function setOrder(val) {
      document.getElementById('hidden-order').value = val;
      document.getElementById('filter-form').submit();
    }
  </script>
{% endblock %}

